package voicemail;

import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import com.google.gson.*;

public class API {
	private boolean _authorized = false;
	JsonObject DB;
	JsonObject user;
	
	public API() {
		_loadDB();
	}
	
	// Authorize Voicemail API Usage
	public boolean Auth(double number, int code) {
		// Load user from matching number
		user = DB.get(String.valueOf(number)).getAsJsonObject();
		
		// If user number is equal to code set _authorized to true
		if (user.get("code").getAsInt() == code) _authorized = true;
		
		return _authorized;
	}
	
	// Add User to DB
	public boolean Add(User user) {
		if (!_authorized) return false;
		
		return true;
	}
	
	// Add voicemail to user
	public boolean Add(User user, Voicemail voicemail) {
		if (!_authorized) return false;
		
		return true;
	}
	
	public boolean Remove() {
		if (!_authorized) return false;
		
		return true;
	}
	
	public boolean Remove(User user, Voicemail voicemail) {
		if (!_authorized) return false;
		
		return true;
	}
	
	public JsonArray GetAll(User user) {
		if (!_authorized) return null;
		
		return "";
	}
	
	private void _loadDB() {
		String DBPath = "/Users/henrysnopek/school/csc341/assignments/assignment07/src/voicemail/Voicemail-DB.json";
		
		try {
			
			JsonParser parser = new JsonParser();
			JsonElement jsonElement = parser.parse(new FileReader(DBPath));
			DB = jsonElement.getAsJsonObject();
			
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
		
		return;
	}
}

interface User {
	public double number;
	public int password;
	public JsonObject voicemails;
}

interface Voicemail {
	public double number;
	public String message = "";
	public boolean read = false;
}
